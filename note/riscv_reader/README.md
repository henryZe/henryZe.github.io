# RISC-V Reader

## 1 ä¸ºä»€ä¹ˆè¦æœ‰RISC-Vï¼Ÿ

**æˆæœ¬**

- åŸå› åœ¨äºç›®å‰çš„ç¡…ç”Ÿäº§å·¥è‰ºä¼šåœ¨æ™¶åœ†ä¸Šç•™ä¸‹ä¸€äº›æ•£å¸ƒçš„å°ç‘•ç–µã€‚å› æ­¤æ™¶ç²’è¶Šå°ï¼Œæœ‰ç¼ºé™·éƒ¨åˆ†æ‰€å æ¯”é‡ä¼šè¶Šä½ã€‚
- cost â‰ˆ f(die area^2) æˆæœ¬ä¸é¢ç§¯çº¦ä¸ºå¹³æ–¹å…³ç³»ã€‚

**ç®€æ´æ€§**

**æ€§èƒ½**

![perf](./1st/perf.png)

**æ¶æ„å’Œå…·ä½“å®ç°çš„åˆ†ç¦»**

**ç¨‹åºå¤§å°**

**æ˜“äºç¼–ç¨‹/ç¼–è¯‘/é“¾æ¥**

## 2 RV32Iï¼šRISC-V åŸºç¡€æ•´æ•°æŒ‡ä»¤é›†

![i_set](./2nd/i_set.png)

### 2.2 æŒ‡ä»¤æ ¼å¼

![i_type](./2nd/i_type.png)

å…­ç§åŸºæœ¬æŒ‡ä»¤æ ¼å¼:
1. å¯„å­˜å™¨-å¯„å­˜å™¨æ“ä½œçš„ R ç±»å‹æŒ‡ä»¤
2. çŸ­ç«‹å³æ•°å’Œè®¿å­˜ load æ“ä½œçš„ I å‹æŒ‡ä»¤
3. è®¿å­˜ store æ“ä½œçš„ S å‹æŒ‡ä»¤
4. æ¡ä»¶è·³è½¬æ“ä½œçš„ B ç±»å‹æŒ‡ä»¤
5. é•¿ç«‹å³æ•°çš„ U å‹æŒ‡ä»¤
6. æ— æ¡ä»¶è·³è½¬çš„ J å‹æŒ‡ä»¤

**ä¹±åºæ‰§è¡Œå¤„ç†å™¨**
> è¿™æ˜¯ä¸€ç§é«˜é€Ÿçš„ã€æµæ°´åŒ–çš„å¤„ç†å™¨ã€‚å®ƒä»¬ä¸€æœ‰æœºä¼šå°±æ‰§è¡ŒæŒ‡ä»¤ï¼Œè€Œä¸æ˜¯åœ¨æŒ‰ç…§ç¨‹åºé¡ºåºã€‚è¿™ç§å¤„ç†å™¨çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯å¯„å­˜å™¨é‡å‘½åï¼ŒæŠŠç¨‹åºä¸­çš„å¯„å­˜å™¨åç§°æ˜ å°„åˆ°å¤§é‡çš„å†…éƒ¨ç‰©ç†å¯„å­˜å™¨ã€‚æ¡ä»¶æ‰§è¡Œçš„é—®é¢˜æ˜¯ä¸ç®¡æ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œéƒ½å¿…é¡»ç»™è¿™äº›æŒ‡ä»¤ä¸­çš„å¯„å­˜å™¨åˆ†é…ç›¸åº”çš„ç‰©ç†å¯„å­˜å™¨ã€‚ä½†å†…éƒ¨ç‰©ç†å¯„å­˜å™¨çš„å¯ç”¨æ€§æ˜¯å½±å“ä¹±åºå¤„ç†å™¨çš„å…³é”®æ€§èƒ½èµ„æºã€‚

### 2.3 å¯„å­˜å™¨

![i_reg](./2nd/i_reg.png)

### 2.4 æ•´æ•°è®¡ç®—

* ç®—æœ¯æŒ‡ä»¤ add, sub
* é€»è¾‘æŒ‡ä»¤ and, or, xor
* ç§»ä½æŒ‡ä»¤ sll, srl, sra

**åˆ©ç”¨ xor æŒ‡ä»¤è¿›è¡Œçš„èŠ±å¼æ“ä½œ**
> å¯ä»¥åœ¨ä¸ä½¿ç”¨ä¸­é—´å¯„å­˜å™¨çš„æƒ…å†µä¸‹äº¤æ¢ä¸¤ä¸ªå€¼ï¼æ­¤ä»£ç äº¤æ¢ x1 å’Œ x2 çš„å€¼ã€‚æç¤ºï¼šå¼‚æˆ–æ“ä½œæ˜¯äº¤æ¢çš„ (ğ‘ âŠ• ğ‘ = ğ‘ âŠ• ğ‘)ï¼Œç»“åˆçš„ ((ğ‘ âŠ• ğ‘) âŠ• ğ‘ = ğ‘ âŠ• (ğ‘ âŠ• ğ‘))ï¼Œæ˜¯å®ƒè‡ªå·±çš„é€†æ“ä½œ (ğ‘ âŠ• ğ‘ = 0)ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå•ä½å…ƒ(ğ‘ âŠ• 0 = ğ‘)ã€‚

~~~ asm
xor x1,x1,x2 # x1â€™ == x1^x2, x2â€™ == x2
xor x2,x1,x2 # x1â€™ == x1^x2, x2â€™ == x1â€™^x2 == x1^x2^x2 == x1
xor x1,x1,x2 # x1â€ == x1â€™^x2â€™ == x1^x2^x1 == x1^x1^x2 == x2, x2â€™ == x1
~~~

### 2.5 Load å’Œ Store

**å­—èŠ‚åºé—®é¢˜**
> RISC-V é€‰æ‹© little endian

### 2.6 æ¡ä»¶åˆ†æ”¯

**ä¸ä½¿ç”¨æ¡ä»¶ç å®ç°å¤§ä½å®½æ•°æ®çš„åŠ æ³•**
> åœ¨ RV32I ä¸­æ˜¯é€šè¿‡ sltu è®¡ç®—è¿›ä½æ¥å®ç°çš„
~~~ asm
add a0,a2,a4 # åŠ ä½ 32 ä½: a0 = a2 + a4
sltu a2,a0,a2 # è‹¥ (a2+a4) < a2 é‚£ä¹ˆ a2â€™ = 1, å¦åˆ™ a2â€™ = 0
add a5,a3,a5 # åŠ é«˜ 32 ä½: a5 = a3 + a5
add a1,a2,a5 # åŠ ä¸Šä½ 32 ä½çš„è¿›ä½
~~~

### 2.7 æ— æ¡ä»¶è·³è½¬



